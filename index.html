<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="msapplication-tap-highlight" content="no" />
        <!-- WARNING: for iOS 7, remove the width=device-width and height=device-height attributes. See https://issues.apache.org/jira/browse/CB-4323 -->
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
			<script type="text/javascript" src="js/index.js"></script>
		<link rel="stylesheet" href="jquery.mobile-1.4.5.css" />
		<script src="jquery-1.11.2.js"></script>
		<script src="jquery.mobile-1.4.5.js"></script>
        <title>Login</title>
    </head>
    <body>
		<div data-role="page">
			<div data-role="header">
				<h1>Login</h1>
			</div><!-- /header -->
			
			<div role="main" class="ui-content">
				<input type="password" placeholder="Please enter your pin to continue" />
				<a href="" data-role="button" onclick="TryLogin();">Login</a>
	
			</div><!-- /content -->

			<!--<div data-role="footer">
			</div> /footer -->

		</div><!-- /page -->			
    </body>
	<script type="text/javascript">
		document.addEventListener("deviceready", onDeviceReady, false);
		
		document.addEventListener("backbutton", onBackKeyDown, false);
		function onBackKeyDown() {
			// this will not allow them to go back into the app after they logout
		}
		
		function onDeviceReady() {
			console.log("device is ready");
			window.plugin.notification.local.add({ message: 'Great app!' });
		}
		
		function TryLogin(){
			$.ajax({
			  type: "POST",
			  url: "http://standardexpress.azurewebsites.net/api/MobileLogin",
			  data: {pin:123456},
			  success: function(response){
						if(response.DriverId != 0){
							LoginSucccess(response);
						}else{
							alert("Invalid PIN");
						}						
					},
			  fail: function(){console.log('error posting to server from watch')}
			});	
		}
		
		function LoginSucccess(driverObject){
			console.log('successfully logged in');
			localStorage.setItem("DriverId", driverObject.DriverId);
			$.mobile.changePage("HomePage.html", { transition: "slidedown"});
		}
	</script>	
</html>
